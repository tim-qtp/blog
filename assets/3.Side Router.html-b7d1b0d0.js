import{_ as e,W as o,X as d,a1 as c}from"./framework-4e10303a.js";const i={},r=c('<p>开始之前，有几个存在的问题。</p><p>如果我只想让手机能科学上网，其他设备全都不能科学上网。</p><p>或者只想让手机不能科学上网，其他设备全都能科学上网。</p><p>这种情况需要你去调整代理工具的分流配置，每个代理工具的设置方式都不太一样，比较繁琐，</p><p>并且你每次改动主路由的配置都可能造成全家设备短暂断网，也可能改崩了导致长时间断网，</p><p>另外如果你的软路由需要运行很多插件，相互之间可能有冲突导致工作不稳定，这些都是负责连接互联网的主路由应该避免的问题。</p><p>这里回顾一下家庭网络吧：使用网线将路由器的WAN口与光猫相连，路由器通过PPPoP拨号获取运营商分配的公网IP，假设为2.2.2.2。除了wan口，路由器还有多个颜色一样的LAN口，为了思路清晰，这里将单独提取出这4个lan口，把它当作一台交换机，并且和路由器这个虚拟的网口建立了连接，路由器连接交换机的这个网口有一个ip地址，假设为192.168.2.1，这个是路由器的内网IP，访问这个ip可以进入路由器的管理界面，同时也是你家里整个局域网的网关ip，你家里所有的网络设备通过网线或者wifi的方式连接到这台交换机，路由器开启了DHCP服务，负责为每一台设备分配ip地址网关等信息，这是大部分家庭的网络拓扑，</p><h4 id="_1-旁路由的基本概念" tabindex="-1"><a class="header-anchor" href="#_1-旁路由的基本概念" aria-hidden="true">#</a> 1. 旁路由的基本概念</h4><p>旁路由是一种在不改变原有家庭网络结构的情况下，通过在主路由旁边接入一台负责科学上网的路由设备（通常刷入<code>OpenWrt</code>系统），来实现特定设备科学上网的方式。主路由仍然负责原有的网络连接工作，而旁路由则处理科学上网等额外任务。</p><h4 id="_2-旁路由的配置步骤" tabindex="-1"><a class="header-anchor" href="#_2-旁路由的配置步骤" aria-hidden="true">#</a> 2. 旁路由的配置步骤</h4><ol><li><strong>确定局域网网段</strong>：首先查看当前电脑的IP地址，确定局域网网段（如<code>192.168.2.x</code>），并记住默认网关（如<code>192.168.2.1</code>）。</li><li><strong>连接软路由</strong>：将电脑连接到刷好<code>OpenWrt</code>的软路由<code>LAN</code>口，等待电脑通过<code>DHCP</code>获取到软路由分配的IP地址和网关。</li><li><strong>配置软路由</strong>： <ul><li>删除默认的<code>WAN</code>口。</li><li>编辑<code>LAN</code>口，设置静态IP地址（如<code>192.168.2.2</code>），网关设置为主路由的IP（如<code>192.168.2.1</code>），并设置DNS为主路由的IP。</li><li>确保<code>DHCP</code>服务开启。</li></ul></li><li><strong>连接主路由</strong>：将旁路由连接到主路由的<code>LAN</code>口，确保旁路由能够正常上网。</li><li><strong>关闭主路由的<code>DHCP</code>服务</strong>：为了避免<code>DHCP</code>冲突，关闭主路由的<code>DHCP</code>服务，让旁路由负责分配IP地址。</li><li><strong>安装科学上网插件</strong>：在旁路由上安装科学上网插件（如<code>Passwall</code>），并导入节点配置。</li></ol><h4 id="_3-按设备分配网关" tabindex="-1"><a class="header-anchor" href="#_3-按设备分配网关" aria-hidden="true">#</a> 3. 按设备分配网关</h4><p>通过<code>dnsmasq</code>的<code>DHCP</code>高级设置，可以为不同设备分配不同的网关和DNS：</p><ul><li><strong>标签为<code>direct</code>的设备</strong>：网关和DNS指向主路由（如<code>192.168.2.1</code>），不经过旁路由。</li><li><strong>标签为<code>proxy</code>的设备</strong>：网关和DNS指向旁路由（如<code>192.168.2.2</code>），经过旁路由科学上网。</li></ul><h4 id="_4-旁路由的常见问题" tabindex="-1"><a class="header-anchor" href="#_4-旁路由的常见问题" aria-hidden="true">#</a> 4. 旁路由的常见问题</h4><ol><li><strong>非对称路由问题</strong>：当数据包的往返路径不一致时，可能会导致某些网站无法访问。可以通过关闭“丢弃无效数据包”选项来解决。</li><li><strong>WiFi设备无法访问国内网站</strong>：某些路由器会将WiFi数据交给<code>iptables</code>处理，导致数据包无法正常进行<code>NAT</code>。可以通过开启<code>IP动态伪装</code>（<code>Masquerade</code>）来解决。</li><li><strong>IPv6问题</strong>：由于<code>IPv6</code>不通过<code>DHCP</code>下发网关，可能会导致设备直接通过主路由访问互联网，绕过旁路由。建议关闭<code>IPv6</code>以避免此类问题。</li></ol><h4 id="_5-旁路由的争议" tabindex="-1"><a class="header-anchor" href="#_5-旁路由的争议" aria-hidden="true">#</a> 5. 旁路由的争议</h4><p>旁路由并非标准的网络拓扑结构，可能会出现各种问题，尤其是在网络结构复杂的情况下。然而，对于大多数家庭用户来说，旁路由配置简单、灵活，能够满足科学上网的需求。因此，旁路由是否适合使用，主要取决于个人的网络需求和结构。</p><h4 id="_6-其他类似旁路由的方案" tabindex="-1"><a class="header-anchor" href="#_6-其他类似旁路由的方案" aria-hidden="true">#</a> 6. 其他类似旁路由的方案</h4><ul><li><strong>安卓手机共享科学上网</strong>：通过开启<code>IP</code>转发，安卓手机可以作为旁路由使用。</li><li><strong>Windows/Linux共享科学上网</strong>：通过配置透明代理，实现类似旁路由的功能。</li><li><strong>Apple TV/Mac Mini共享</strong>：使用<code>Surge</code>等工具的网关模式，实现旁路由的功能。</li></ul>',20),a=[r];function n(t,l){return o(),d("div",null,a)}const h=e(i,[["render",n],["__file","3.Side Router.html.vue"]]);export{h as default};
